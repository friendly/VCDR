## Chapter 3

### Exercise 3.1 

The Arbuthnot data in HistData (Example 3.1) also contains the variable Ratio,
giving the ratio of male to female births.

a. Make a plot of `Ratio` over `Year`, similar to Figure 3.1. What features stand out? 
Which plot do you prefer to display the tendency for more male births?
```{r ex3.1a}
library(HistData)
data(Arbuthnot, package ="HistData")

# plot of Ratio by Year
with(Arbuthnot, {
  plot(Year, Ratio, type='b', ylim=c(.95, 1.2), ylab="Birth Ratio (Male/Female)")
  abline(h=1, col="green", lwd=1)
  abline(h=mean(Ratio), col="red")
  text(x=1660, y=1, "Equal M/F ratio", pos=1, col="green3") 
  Arb.smooth <- loess.smooth(Year,Ratio)
  lines(Arb.smooth$x, Arb.smooth$y, col="blue", lwd=2)
})
summary(Arbuthnot$Ratio)

```

The plot is similar to Figure 3.1 in text. If it is easier to think in terms of probability of a male birth,
plotting that directly may be preferable.

b. Plot the total number of christenings, `Males + Females` or `Total` (in 000s) over time.
What unusual features do you see?

```{r ex3.1b}
# total number of Christenings
with(Arbuthnot, {
  Total= Males + Females
  plot(Year, Total, type='b', ylab="Total Christenings (Male + Female)")
  Arb.smooth <- loess.smooth(Year,Total)
  lines(Arb.smooth$x, Arb.smooth$y, col="blue", lwd=2)
})
```

There was a large decline in births between 1640--1660, corresponding to years of plague in England.

### Exercise 3.3

a. Produce plots analogous to those shown in Section 3.1 (some sort of bar graph of frequencies)
```{r ex3.3a}
data("WomenQueue", package = "vcd")
barplot(WomenQueue,xlab="Number of Women in queues of 10",ylab= "Frequency")
```

b. Check for goodness-of-fit to the binomial distribution using the `goodfit()` methods described
in Section 3.3.2.

```{r ex3.3b}
library(vcd)
gf.women <- goodfit(WomenQueue, type = "binomial", par=list(size=10))
summary(gf.women)
```

c. Make a reasonable plot showing departure from the binomial distribution.

```{r ex3.3c}
plot(gf.women)
```

d. Suggest some reasons why the number of women in queues of length 10 might depart from a binomial distribution, $Bin(n=10, p=1/2)$.

(A) Perhaps women (or men) are more prevalent in these queues, so $p \ne 1/2$.
(B) People often join lines in groups, so the observations are unliekly to be independent.

### Exercise 3.4

Continue Example 3.13 on the distribution of male children in families in Saxony by fitting a binomial distribution, 
$Bin(n = 12; p = 1/2 )$, specifying equal probability for boys and girls. 

a. Carry out the GOF test for this fixed binomial distribution. What is the ratio of Chi-sqrare/df? What
do you conclude?

Note that you need to specify both $n$ and $p$ as fixed parameters here.
```{r ex3.4a}
Saxony_gf <-goodfit(Saxony, type = "binomial", par=list(size=12, prob=.5))
ss <-summary(Saxony_gf)
# The ratio of Chi-square/df
ss[,"X^2"] / ss[,"df"]
```
The binomial model fits very badly.

b. Test the additional lack of fit for the model Bin(n = 12; p = 1/2 ) compared to the model
$Bin(n = 12; p = \hat{p})$ where $\hat{p} is estimated from the data.

```{r ex3.4b}
Saxony_gf2 <- goodfit(Saxony, type = "binomial", par=list(size=12))
summary(Saxony_gf2)
```
This fits much better, but still not a good fit. 

c. Use the `plot.goodfit()` method to visualize these two models.

```{r ex3.4c}
plot(Saxony_gf, main = "Fit for p=0.5")
plot(Saxony_gf2, main= "Fit for p=phat")
```

### Exercise 3.5

### Exercise 3.6 

Mosteller and Wallace (1963, Table 2.4) give the frequencies, $n_k$, of counts $k =
0, 1, \dots$ of other selected marker words in 247 blocks of text known to have been written by Alexander Hamilton. The data below show the occurrences of the word *upon*, that Hamilton used much
more than did James Madison.

a. Read these data into R and construct a one-way table of frequencies of counts or a matrix or
data frame with frequencies in the first column and the corresponding counts in the second
column, suitable for use with `goodfit()`.

`goodfit()` requires its first argument to be either a one-way table (from `xtabs()`),
or a data.frame with frequencies in the *first* column and the corresponding counts in the second column.  Both of the following forms will work.
```{r upon1}
count <- 0:5
Freq <- c(129, 83, 20, 9, 5, 1)
sum(Freq)  # check N

(Upon <- data.frame(Freq, count))             # as a data.frame
(Upon.tab <- xtabs(Freq ~ count, data=Upon))  # one-way table

```

b. Fit and plot the Poisson model for these frequencies.
```{r upon2}
(up0 <- goodfit(Upon, type="poisson"))
summary(up0)
plot(up0)
```

c. Fit and plot the negative binomial model for these frequencies.
```{r}
(up1 <- goodfit(Upon, type="nbinomial"))
summary(up1)
plot(up1)
```

d. What do you conclude?

### Exercise 3.7

### Exercise 3.8

### Exercise 3.9

### Exercise 3.10

### Exercise 3.11

### Exercise 3.12

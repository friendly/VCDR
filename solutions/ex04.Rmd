---
output: word_document
---
## Chapter 4: Two-Way Contingency Tables

### Exercise 4.1

The data set fat, created below, gives a $2 \times 2$ table recording
the level of cholesterol in diet and the presence of symptoms of heart
disease for a sample of 23 people.

```{r fat}
fat <- matrix(c(6, 4, 2, 11), 2, 2) 
dimnames(fat) <- list(diet = c("LoChol", "HiChol"), disease = c("No", "Yes")) 
```

(a) Use `chisq.test(fat)` to test for association between diet and disease. Is
there any indication that this test may not be appropriate here?

(b) Use a fourfold display to test this association visually. Experiment
with the different options for standardizing the margins, using the
margin argument to fourfold. What evidence is shown in different
displays regarding whether the odds ratio differs significantly from 1?

(c) `oddsratio(fat, log = FALSE)` will give you a numerical answer. How does
this compare to your visual impression from fourfold displays?

(d) With such a small sample, Fisher’s exact test may be more reliable for
statistical inference. Use `fisher.test(fat)`, and compare these results
to what you have observed before.

(e) Write a one-paragraph summary of your findings and conclusions for this
data set.

### Exercise 4.2

The data set Abortion in vcdExtra gives a $2 \times 2 \times 2$ table of
opinions regarding abortion in relation to sex and status of the
respondent. This table has the following structure: 

```{r abortion}
data("Abortion", package = "vcdExtra") 
str(Abortion) 
```

(a) Taking support for abortion as the outcome variable, produce fourfold
displays showing the association with sex, stratified by status.

(b) Do the same for the association of support for abortion with status,
stratified by sex.

(c) For each of the problems above, use oddsratio to calculate the numerical
values of the odds ratio, as stratified in the question.

(d) Write a brief summary of how support for abortion depends on sex and
status.

### Exercise 4.3

The `JobSat` table on income and job satisfaction created in Example 2.5 is
contained in the vcdExtra package.

(a) Carry out a standard $\chi^2$ test for association between income and
job satisfaction. Is there any indication that this test might not be
appropriate? Repeat this test using simulate.p.value = TRUE to obtain a
Monte Carlo test that does not depend on large sample size. Does this
change your conclusion?

(b) Both variables are ordinal, so CMH tests may be more powerful here.
Carry out that analysis. What do you conclude?

### Exercise 4.4

The `Hospital` data in vcd gives a $3 \times 3$ table relating the length
of stay (in years) of 132 long-term schizophrenic patients in two London
mental hospitals with the frequency of visits by family and friends.

(a) Carry out a $\chi^2$ test for association between the two variables.

(b) Use `assocstats()` to compute association statistics. How would you describe
the strength of association here?

(c) Produce an association plot for these data, with visit frequency as the
vertical variable. Describe the pattern of the relation you see here.

(d) Both variables can be considered ordinal, so CMH tests may be useful here.
Carry out that analysis. Do any of the tests lead to different
conclusions?

### Exercise 4.5

Continuing with the `Hospital` data:

(a) Try one or more of the following other functions for visualizing two-way
contingency tables with this data: `plot()`, `tile()`, `mosaic()`, and `spineplot()`.
[For all except spineplot, it is useful to include the argument
`shade=TRUE`].

(b) Comment on the differences among these displays for understanding the
relation between visits and length of stay.

### Exercise 4.6

The two-way table `Mammograms` in vcdExtra gives ratings on the severity
of diagnosis of 110 mammograms by two raters.

(a) Assess the strength of agreement between the raters using Cohen’s
$\kappa$, both unweighted and weighted.

(b) Use `agreementplot()` for a graphical display of agreement here.

(c) Compare the Kappa measures with the results from `assocstats()`. What is a
reasonable interpretation of each of these measures?

### Exercise 4.7

Agresti and Winner (1997) gave the data in Table 4.1 on the
ratings of 160 movies by the reviewers Gene Siskel and Roger Ebert for
the period from April 1995 through September 1996. The rating categories
were Con (“thumbs down”), Mixed, and Pro (“thumbs up”).
<!-- ch04/tab/siskel-ebert -->
```
               Ebert
       Con  Mixed  Pro  Total  
Con     24      8    13    45  
Mixed    8     13    11    32  
Pro     10      9    64    83  
Total   42     30    88   160  
```

(a) Assess the strength of agreement between the raters using Cohen’s
$\kappa$, both unweighted and weighted.

(b) Use `agreementplot()` for a graphical display of agreement here.

(c) Assess the hypothesis that the ratings are *symmetric* around the main
diagonal, using an appropriate $\chi^2$ test. *Hint*: Symmetry for a
square table $\mat{T}$ means that $t_{ij} = t_{ji}$ for $i \ne j$. The
expected frequencies under the hypothesis of symmetry are the average of
the off-diagonal cells, $\mat{E} = (\mat{T} + \mat{T}\trans) / 2$.

(d) Compare the results with the output of `mcnemar.test()`.

### Exercise 4.8

For the `VisualAcuity` data set:

(a) Use the code shown in the text to create the table form, `VA.tab`.

(b) Perform the CMH tests for this table.

(c) Use the `woolf_test()` described in sec:twoway-homog to test whether the
association between left and right eye acuity can be considered the same
for men and women.

### Exercise 4.9 

The graph in Figure 4.23 may be misleading, in that it doesn’t take
into account of the differing capacities of the 18 life boats on the
*Titanic*, given in the variable cap in the Lifeboats data.

(a) Calculate a new variable, `pctloaded`, as the percentage loaded relative
to the boat capacity.

(b) Produce a plot similar to Figure 4.23, showing the changes over time
in this measure.

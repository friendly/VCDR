\chapter{Loglinear and logit models}\label{ch:loglin}
\input{ch7/vtoc}
\begin{quote}
{\Large
Loglinear models are most easily interpreted through
visualizations, including mosaic displays and plots of associated
logit models.  As with logistic regression, diagnostic plots
and influence plots help to assure that the fitted model is
an adequate summary of associations among variables.
}
\end{quote}
\minitoc

\section{Introduction}
\epigraph{We share a philosophy about linear algebra: we think
basis-free, we write basis-free, but when the chips are down we close
the office door and compute with matrices like fury.}
{Irving Kaplansky, in \emph{Paul Halmos: Celebrating 50 Years of Mathematics}}

Loglinear models provide a comprehensive scheme to describe and
understand the associations among two or more categorical variables.
Whereas logit models focus on the prediction of one response factor,
\loglin\ models treat all variables symmetrically, and attempt to
model all important associations among them.  In this sense,
\loglin\ models are analogous to a correlation analysis of continuous
variables, where the goal is to determine the patterns of dependence
and independence among a set of variables.   Nonetheless, when
one variable is indeed a response and the others are explanatory,
certain \loglin\ models are equivalent to logit models for that
response.

\chref{ch:mosaic} and \chref{ch:corresp} introduced some aspects of
\loglin\ models in connection with mosaic displays and correspondence analysis.  
\ix{correspondence analysis}
\ix{mosaic display}
In this chapter, the focus is on fitting and interpreting
\loglin\ models.  The usual analyses, with \PROC{CATMOD} and
\PROC{GENMOD} present the results in terms of tables of parameter
estimates.  Particularly for larger tables, it becomes difficult
to understand the nature of these associations from tables
of parameter estimates.  Instead, we emphasize plots of observed
and predicted probabilities or log odds (when there are one or more response
variables), as well as mosaic and other displays for interpreting a given
model, and residual and influence plots for model diagnostics.
We also illustrate how mosaic displays and \CA\ plot may be used
in a complementary way to the usual numerical summaries, to provide
additional insights into the data.

\secref{sec:loglin-counts} gives a brief overview of \loglin\
models in relation to the more familiar ANOVA and regression models
for quantitative data.
Methods and software for fitting these models are discussed in 
\secref{sec:loglin-fitting}.
When one variable is a response, logit models for that response provide
a simpler, but equivalent means for interpreting and graphing
results of \loglin\ models, as we describe in \secref{sec:loglin-logit}.
Another class of simplified models (\secref{sec:loglin-ordinal})
occurs when one or more of the explanatory variables are ordinal,
and discrete levels might be replaced by numerical values.
\secref{sec:loglin-vietnam} presents an extended example illustrating
the interplay between model fitting and graphical displays.
As in logistic regression models, there are analogs of
model diagnostics for \loglin\ models.
These statistics  and related visualizations are described in
\secref{sec:loglin-infl}.
The final section (\secref{sec:loglin-multiv}) illustrates some
more comprehensive \loglin\ models for two or more response variables.

The models and methods described here attempt to go beyond the typical
presentations of \loglin\ models.   That is, the topics discussed
and examples presented in this chapter
encompass specialized forms of \loglin\ models
for one response variable, for ordinal explanatory variables, and for
multiple response variables.  This treatment is perhaps at the expense of more
basic models, which were examined in \chref{ch:mosaic} and \chref{ch:corresp}
from an exploratory perspective.
The reader may also wish to consult \CDAref{\C 14},
\citet[\C 10]{Allison:99}, and
\citet[\C 4--5]{Zelterman:99} for additional examples of fitting and
interpretation of \loglin\ models using SAS,
and \citet[\C 6--8]{Agresti:90}, or \citet{Christensen:97}
for additional theory and worked examples.


\input{ch7/counts}
\input{ch7/fitting}
%\section{Two-way tables}\label{sec:loglin-twoway}
\input{ch7/logit}
\input{ch7/ordinal}

\section{An extended example}\label{sec:loglin-vietnam}
Any model is a summary, and even a reasonably good-fitting model is not always sensible or faithful to the details of the data.
The interplay between graphing and fitting is important in arriving at
an understanding of the relations among the variables
and an adequate descriptive model.
This section describes the analysis of a moderately large three-way
table, where we find that graphical displays play a crucial role
in directing our understanding and model representation.

\input{ch7/vietnam}
\input{ch7/mosviet}
\input{ch7/influence}
\input{ch7/multiv}

\section{Chapter summary}
\begin{itemize}
\item Loglinear models provide a comprehensive scheme to describe and
understand the associations among two or more categorical variables.
It is helpful to think of these as discrete analogs of ANOVA models,
or of regression models, where the log of cell frequency is modelled
as a linear function of predictors.

\item Loglinear models may be fit using \PROC{CATMOD}, \PROC{GENMOD},
\INSIGHT, or \IML.  Each of these offers certain advantages and
disadvantages.

\item Loglinear models typically make no distinction between response
and explanatory variables.
When one variable \emph{is} a response, however, any logit model for
that response has an equivalent \loglin\ model.
The logit form is usually simpler to formulate and test, and plots of
the observed and fitted logits are easier to interpret.
Plotting the results of logit models fit with \PROC{CATMOD}
is facilitated by the \macro{CATPLOT}.

\item Standard \loglin\ models treat all variables as unordered factors.
When one or more factors are ordinal, however, \loglin\ and logit models
may be simplified by assigning quantitative scores to the levels of
an ordered factor.
Such models are often more sensitive and have greater power because they
are more focused.

\item The interplay between graphing and fitting is important in 
arriving at an understanding of the relationships among variables and
an adequate descriptive model which is faithful to the details of the
data.

\item Model diagnostic statistics
(adjusted residuals, leverage, Cook's D, etc)
provide important ancillary information regarding the adequacy of
a \loglin\ model as a summary of the relationships in the data.
Half-normal probability plots, tuned to the discrete nature of categorical
data help to detect outlying cells, and are provided by the \macro{HALFNORM}.
A variety of diagnostic plots provided by the \macro{INFLGLIM}
aid in detecting unduly influential cells.

\item When there are several categorical responses, along with one or
more explanatory variables, some special forms of \loglin\ and logit
models may be used to separate the marginal dependence of each response
on the explanatory variables from the interdependence among the responses.


\end{itemize}


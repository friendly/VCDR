\section{Fitting discrete distributions}\label{sec:discrete-fit}

Often interest is focused on how closely such data follow a
particular distribution, such as the Poisson, binomial, or geometric
distribution.  Usually this is examined with a classical (Pearson)
goodness-of-fit chi-square test,
\glosstex{chi-square test}

\begin{equation}\label{eq:chi2}
  \chi^2 = \sum_{k=1}^K \:
  \frac{{ ( n_k - N \hat{p}_k ) }^2}
  { N \hat{p}_k }  \sim \chi^2_{( K-s-1 )}
  \comma
\end{equation}
where there are $K$ frequency classes, 
$s$ parameters have been estimated from the data and
\(\hat{p}_k\) is the estimated probability of each basic count,
under the null hypothesis that the data follows the chosen distribution.
An alternative test statistic is the likelihood-ratio $G^2$
statistic,
\begin{equation}\label{eq:g2}
 G^2 = \sum_{k=1}^K \: n_k \log ( n_k / N \hat{p}_k )
 \comma
\end{equation}
when the $\hat{p}_k$ are estimated by maximum likelihood,
which also has an asymptotic $\chi^2_{(K - s - 1)}$ distribution.
``Asymptotic'' means that these are large sample tests.
A common rule of thumb is that all expected frequencies
should exceed one and that fewer than 20\% should be less than 5.

For the horse kick data, the mean is 122/200 = .610, and calculation
of Poisson probabilities (\texttt{PHAT}), expected frequencies, and
contributions to \(\chi^2\) \eqref{eq:chi2} are shown below.
\ixd{deaths by horsekick}

\begin{center}
\begin{alltt}
 k     nk      p        phat         exp     chisq

 0    109    0.545    0.54335    108.670    0.00100
 1     65    0.325    0.33144     66.289    0.02506
 2     22    0.110    0.10109     20.218    0.15705
 3      3    0.015    0.02056      4.111    0.30025
 4      1    0.005    0.00313      0.627    0.22201
      ===                        =======    =======
      200                        199.915    0.70537 \(\sim \chi\sp2 (3)\)
\end{alltt}
\end{center}

In this case the \(\chi^2\) shows an exceptionally good (perhaps unreasonably
good?) fit.  In the word frequency example
(\exref{ex:madison1}), the fit of the Poisson
turns out not to be close at all.  However, even a close fit may show
something interesting, if we know how to look; conversely, it is
useful to know why or where the data differ from a chosen model.

\input{ch2/fitgood}
\input{ch2/fitplot}
\input{ch2/fitroot}
\input{ch2/fitmle}
\input{ch2/fitllm}

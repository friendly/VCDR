#include $(HOME)/Unix/lib/make_latex

# book.mak lists all dependencies among the book files (generated by texdepend)
# I don't actually use it in this Makefile

include book.mak

# # Name(s) of LaTeX document file(s) (without suffixes)
# # eg.
FILES = book
CHAPTERS = ch1 ch2 ch3 ch4 ch5 ch6 ch7 macros data tables
#

ZIP = /LocalApps/Utilities/Opener.app/zip

TOP = README.txt book.tex book.bbl book.aei* book.ida book.ide book.idx book.in* book.ist book.lo* book.mtc* book.toc commands.tex indsee.tex Makefile book.mak toc.*
BIN = bin/*
FRONT = front.* front/covpic.tex preface.*
#CHSRC = ch1.* ch2.* ch3.* ch4.* ch5.* ch6.* ch7.* ch1/* ch2/* ch3/* ch4/* ch5/* ch6/* ch7/*
CHSRC = ch*.* ch*/*
APPSRC = macros.* data.* tables.* macros/* data/* tables/*
BIBSRC =
INPUTS = inputs/*
EXCLUDE = *.jpg *.dvi *.ps

BOOKPS = book0.ps book1.ps book2.ps book3.ps book4.ps book5.ps book6.ps book7.ps booka.ps bookb.ps bookc.ps bookref.ps bookind.ps

vcdsrc :
	$(ZIP) -r vcdsrc $(TOP) $(BIN) $(CHSRC) $(APPSRC) $(INPUTS) -x $(EXCLUDE)

vcdps :
	cd zip; \
	$(ZIP) -u vcdps $(BOOKPS)

index :
#  subject index
	makeindex -o book.ind -s book.ist book.idx
#  example index
	makeindex -o book.ine book.ide
#  author/editor index -- requires two separate passes, each generating
#  book.aei, then 
#    mv book.aei book.aei1 (or aei2)
	mv book.ida book.ida~
	authidx book.aei* > book.ida
	makeindex -o book.ina book.ida

book.mak :
	texdepend -expand -format=make -out=book.mak book

newfig :
	find . -follow -newer book.unref -name '*.eps' -path './ch*' | zip -@ newfig

newtex :
	find . -follow -newer vcdsrc.zip -name '*.tex' | zip -@ newtex
